<body>
<table class="book-table">
	<tr>
		<th></th>
		<th>Title</th>
		<th>Author</th>
	</tr>
	{% for book in books %}
	<tr>
	   <td>
	   		{% if book.thumbnail_link %}
	   			<img src="{{ book.thumbnail_link }}" class="thumbnail" />
	   		{% else %}
	   			No Image Found
	   		{% endif %}
	   </td>
	   <td>{{book.title}}</td>
	   <td>{{book.authors}}</td>
	   {% if show_add_buttons %}
			<td>
		   		<form id="form-add{{ book.google_books_id }}" data-book-id="{{ book.google_books_id }}" class="add-book-form" action="/books/add" method="POST">
		   			<input type="hidden" name="google_books_id" value="{{book.google_books_id}}"/>
					<input type="hidden" name="title" value="{{book.title}}"/>
		   			<input type="hidden" name="authors" value="{{book.authors}}"/>
		   			<input type="hidden" name="thumbnail_link" value="{{book.thumbnail_link}}"/>
		   			<button type="button" id="addButton-{{book.google_books_id}}" class="formButton addButton">Add</button>
		   		</form>
		   	</td>	   
	   	{% endif %}
	</tr>
	{% endfor %}
</table>

<script>
	$(document).ready(function() {
	    $('.addButton').click(function() {
	    	var buttonId = $(this).attr('id');
	        $.ajax({
	            url: "{{ url_for('add_book') }}",
	            data: $(this).parent().serialize(), 
	            type: 'POST',
	            success: function(response) {
	                console.log(response);
	                var button = $('#' + buttonId);
	                var td = button.parent().parent();
	                button.hide();
	                td.append("Added");
	            },
	            error: function(error) {
	                console.log(error);
	            }
	        });
	    });
	});
 // wait for the DOM to be loaded
 // $(function() {
 // 	alert("Add book clicked");
 //   // bind 'myForm' and provide a simple callback function
 //   $('.add-book-form').ajaxForm(function() {
 //       alert("Book added!");
 //   });
 // });
</script>
</body>